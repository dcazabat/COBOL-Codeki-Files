/* REXX - MACRO PARA 4 PANTALLAS EN SWAPLIST - AUTORRECUPERABLE */
ADDRESS TSO

/* Verificar si estamos dentro de ISPF */
IF SYMBOL('SYSISPF') \= 'VAR' THEN DO
  SAY "⚠️ No estás en ISPF. Lanzando ISPF..."
  "ISPF CMD(%VENTANAS)"
  EXIT 0
END

ADDRESS ISPEXEC
"CONTROL ERRORS RETURN"

/* 1. DSLIST (Menú 3.4) */
"SELECT PGM(ISPUDA) PARM(PANEL(ISPUDL)) NEWAPPL(ISR)"
IF RC = 0 THEN
  "DISPLAY PANEL(ISRDDN) OPT(D) DDN(1) DN(ISPUDA) DNNAME('MYLIB')"
ELSE
  SAY "AVISO: No se pudo abrir DSLIST. RC="RC

/* 2. Programa COMPTEST */
"EDIT DATASET('KC03C7C.CURSOS.FUENTE(COMPTEST)') NEWAPPL(ISR)"
IF RC = 0 THEN
  "DISPLAY PANEL(ISRDDN) OPT(D) DDN(2) DN(ISREDIT) DNNAME('COMPILA')"
ELSE
  SAY "AVISO: No se pudo abrir COMPTEST. RC="RC

/* 3. Dataset JCLLIB */
"BROWSE DATASET('KC03C7C.CURSOS.JCLLIB') NEWAPPL(ISR)"
IF RC = 0 THEN
  "DISPLAY PANEL(ISRDDN) OPT(D) DDN(3) DN(ISRBRO) DNNAME('JCL')"
ELSE
  SAY "AVISO: No se pudo abrir JCLLIB. RC="RC

/* 4. SPOOL (SD.ST) */
"SELECT PGM(ISFISP) PARM(SD.ST) NEWAPPL(ISR)"
IF RC = 0 THEN
  "DISPLAY PANEL(ISRDDN) OPT(D) DDN(4) DN(ISFISP) DNNAME('SPOOL')"
ELSE
  SAY "AVISO: No se pudo abrir SPOOL. RC="RC

"SETMSG MSG(ISRZ001)"
SAY "✅ Macro completada. Use SWAP (F9) para ver las pantallas."

EXIT 0
